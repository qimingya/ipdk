
vxlan§D{
  "schema_version" : "1.0.0",
  "tables" : [
    {
      "name" : "pipe.ingress.vxlan",
      "id" : 33686666,
      "table_type" : "MatchAction_Direct",
      "size" : 65536,
      "annotations" : [],
      "depends_on" : [],
      "has_const_default_action" : true,
      "key" : [
        {
          "id" : 1,
          "name" : "hdr.ethernet.dst_addr",
          "repeated" : false,
          "annotations" : [],
          "mandatory" : false,
          "match_type" : "Exact",
          "type" : {
            "type" : "bytes",
            "width" : 48
          }
        }
      ],
      "action_specs" : [
        {
          "id" : 32131245,
          "name" : "ingress.vxlan_encap",
          "action_scope" : "TableAndDefault",
          "annotations" : [],
          "data" : [
            {
              "id" : 1,
              "name" : "ethernet_dst_addr",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 48
              }
            },
            {
              "id" : 2,
              "name" : "ethernet_src_addr",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 48
              }
            },
            {
              "id" : 3,
              "name" : "ethernet_ether_type",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 4,
              "name" : "ipv4_ver_ihl",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 5,
              "name" : "ipv4_diffserv",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 6,
              "name" : "ipv4_total_len",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 7,
              "name" : "ipv4_identification",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 8,
              "name" : "ipv4_flags_offset",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 9,
              "name" : "ipv4_ttl",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 10,
              "name" : "ipv4_protocol",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 11,
              "name" : "ipv4_hdr_checksum",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 12,
              "name" : "ipv4_src_addr",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 32
              }
            },
            {
              "id" : 13,
              "name" : "ipv4_dst_addr",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 32
              }
            },
            {
              "id" : 14,
              "name" : "udp_src_port",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 15,
              "name" : "udp_dst_port",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 16,
              "name" : "udp_length",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 17,
              "name" : "udp_checksum",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 16
              }
            },
            {
              "id" : 18,
              "name" : "vxlan_flags",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 19,
              "name" : "vxlan_reserved",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 24
              }
            },
            {
              "id" : 20,
              "name" : "vxlan_vni",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 24
              }
            },
            {
              "id" : 21,
              "name" : "vxlan_reserved2",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 8
              }
            },
            {
              "id" : 22,
              "name" : "port_out",
              "repeated" : false,
              "mandatory" : true,
              "read_only" : false,
              "annotations" : [],
              "type" : {
                "type" : "bytes",
                "width" : 32
              }
            }
          ]
        },
        {
          "id" : 33281717,
          "name" : "ingress.drop",
          "action_scope" : "TableAndDefault",
          "annotations" : [],
          "data" : []
        },
        {
          "id" : 21257015,
          "name" : "NoAction",
          "action_scope" : "DefaultOnly",
          "annotations" : [
            {
              "name" : "@defaultonly"
            }
          ],
          "data" : []
        }
      ],
      "data" : [],
      "supported_operations" : [],
      "attributes" : ["EntryScope"]
    }
  ],
  "learn_filters" : []
}‘x
pipeÚW{
  "program_name" : "vxlan",
  "build_date" : "Tue Aug  2 07:03:34 2022",
  "compile_command" : "/usr/local/bin/p4c-dpdk -I /usr/local/share/p4c/p4include --p4v=16 --p4runtime-files /git/ipdk/build/networking/examples/vxlan/p4Info.txt -I /usr/local/share/p4c/p4include/dpdk -o /git/ipdk/build/networking/examples/vxlan/pipe/vxlan.spec /git/ipdk/build/networking/examples/vxlan/pipe/vxlan.p4i --arch psa --bf-rt-schema /git/ipdk/build/networking/examples/vxlan/bf-rt.json --context /git/ipdk/build/networking/examples/vxlan/pipe/context.json",
  "compiler_version" : "0.1 (SHA: 45e5d7024 BUILD: RELEASE)",
  "schema_version" : "0.1",
  "target" : "DPDK",
  "tables" : [
    {
      "name" : "ingress.vxlan",
      "direction" : "ingress",
      "handle" : 65536,
      "table_type" : "match",
      "size" : 65536,
      "p4_hidden" : false,
      "stateful_table_refs" : [],
      "statistics_table_refs" : [],
      "meter_table_refs" : [],
      "match_key_fields" : [
        {
          "name" : "hdr.ethernet.dst_addr",
          "instance_name" : "hdr.ethernet",
          "field_name" : "dst_addr",
          "match_type" : "exact",
          "start_bit" : 0,
          "bit_width" : 48,
          "bit_width_full" : 48,
          "position" : 0
        }
      ],
      "actions" : [
        {
          "name" : "ingress.vxlan_encap",
          "handle" : 131072,
          "constant_default_action" : false,
          "is_compiler_added_action" : false,
          "allowed_as_hit_action" : true,
          "allowed_as_default_action" : false,
          "p4_parameters" : [
            {
              "name" : "ethernet_dst_addr",
              "start_bit" : 0,
              "bit_width" : 48,
              "position" : 0,
              "byte_array_index" : 0
            },
            {
              "name" : "ethernet_src_addr",
              "start_bit" : 0,
              "bit_width" : 48,
              "position" : 1,
              "byte_array_index" : 6
            },
            {
              "name" : "ethernet_ether_type",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 2,
              "byte_array_index" : 12
            },
            {
              "name" : "ipv4_ver_ihl",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 3,
              "byte_array_index" : 14
            },
            {
              "name" : "ipv4_diffserv",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 4,
              "byte_array_index" : 15
            },
            {
              "name" : "ipv4_total_len",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 5,
              "byte_array_index" : 16
            },
            {
              "name" : "ipv4_identification",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 6,
              "byte_array_index" : 18
            },
            {
              "name" : "ipv4_flags_offset",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 7,
              "byte_array_index" : 20
            },
            {
              "name" : "ipv4_ttl",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 8,
              "byte_array_index" : 22
            },
            {
              "name" : "ipv4_protocol",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 9,
              "byte_array_index" : 23
            },
            {
              "name" : "ipv4_hdr_checksum",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 10,
              "byte_array_index" : 24
            },
            {
              "name" : "ipv4_src_addr",
              "start_bit" : 0,
              "bit_width" : 32,
              "position" : 11,
              "byte_array_index" : 26
            },
            {
              "name" : "ipv4_dst_addr",
              "start_bit" : 0,
              "bit_width" : 32,
              "position" : 12,
              "byte_array_index" : 30
            },
            {
              "name" : "udp_src_port",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 13,
              "byte_array_index" : 34
            },
            {
              "name" : "udp_dst_port",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 14,
              "byte_array_index" : 36
            },
            {
              "name" : "udp_length",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 15,
              "byte_array_index" : 38
            },
            {
              "name" : "udp_checksum",
              "start_bit" : 0,
              "bit_width" : 16,
              "position" : 16,
              "byte_array_index" : 40
            },
            {
              "name" : "vxlan_flags",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 17,
              "byte_array_index" : 42
            },
            {
              "name" : "vxlan_reserved",
              "start_bit" : 0,
              "bit_width" : 24,
              "position" : 18,
              "byte_array_index" : 43
            },
            {
              "name" : "vxlan_vni",
              "start_bit" : 0,
              "bit_width" : 24,
              "position" : 19,
              "byte_array_index" : 46
            },
            {
              "name" : "vxlan_reserved2",
              "start_bit" : 0,
              "bit_width" : 8,
              "position" : 20,
              "byte_array_index" : 49
            },
            {
              "name" : "port_out",
              "start_bit" : 0,
              "bit_width" : 32,
              "position" : 21,
              "byte_array_index" : 50
            }
          ]
        },
        {
          "name" : "ingress.drop",
          "handle" : 131073,
          "constant_default_action" : true,
          "is_compiler_added_action" : false,
          "allowed_as_hit_action" : true,
          "allowed_as_default_action" : true,
          "p4_parameters" : []
        },
        {
          "name" : "NoAction",
          "handle" : 131074,
          "constant_default_action" : false,
          "is_compiler_added_action" : false,
          "allowed_as_hit_action" : true,
          "allowed_as_default_action" : false,
          "p4_parameters" : []
        }
      ],
      "match_attributes" : {
        "stage_tables" : [
          {
            "action_format" : [
              {
                "action_name" : "ingress.vxlan_encap",
                "target_action_name" : "ingress.vxlan_encap",
                "action_handle" : 131072,
                "immediate_fields" : [
                  {
                    "param_name" : "ethernet_dst_addr",
                    "dest_start" : 0,
                    "dest_width" : 48
                  },
                  {
                    "param_name" : "ethernet_src_addr",
                    "dest_start" : 6,
                    "dest_width" : 48
                  },
                  {
                    "param_name" : "ethernet_ether_type",
                    "dest_start" : 12,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "ipv4_ver_ihl",
                    "dest_start" : 14,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "ipv4_diffserv",
                    "dest_start" : 15,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "ipv4_total_len",
                    "dest_start" : 16,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "ipv4_identification",
                    "dest_start" : 18,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "ipv4_flags_offset",
                    "dest_start" : 20,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "ipv4_ttl",
                    "dest_start" : 22,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "ipv4_protocol",
                    "dest_start" : 23,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "ipv4_hdr_checksum",
                    "dest_start" : 24,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "ipv4_src_addr",
                    "dest_start" : 26,
                    "dest_width" : 32
                  },
                  {
                    "param_name" : "ipv4_dst_addr",
                    "dest_start" : 30,
                    "dest_width" : 32
                  },
                  {
                    "param_name" : "udp_src_port",
                    "dest_start" : 34,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "udp_dst_port",
                    "dest_start" : 36,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "udp_length",
                    "dest_start" : 38,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "udp_checksum",
                    "dest_start" : 40,
                    "dest_width" : 16
                  },
                  {
                    "param_name" : "vxlan_flags",
                    "dest_start" : 42,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "vxlan_reserved",
                    "dest_start" : 43,
                    "dest_width" : 24
                  },
                  {
                    "param_name" : "vxlan_vni",
                    "dest_start" : 46,
                    "dest_width" : 24
                  },
                  {
                    "param_name" : "vxlan_reserved2",
                    "dest_start" : 49,
                    "dest_width" : 8
                  },
                  {
                    "param_name" : "port_out",
                    "dest_start" : 50,
                    "dest_width" : 32
                  }
                ]
              },
              {
                "action_name" : "ingress.drop",
                "target_action_name" : "ingress.drop_1",
                "action_handle" : 131073,
                "immediate_fields" : []
              },
              {
                "action_name" : "NoAction",
                "target_action_name" : "NoAction",
                "action_handle" : 131074,
                "immediate_fields" : []
              }
            ]
          }
        ]
      },
      "default_action_handle" : 131073
    }
  ]
}¥ 

struct ethernet_h {
	bit<48> dst_addr
	bit<48> src_addr
	bit<16> ether_type
}

struct ipv4_h {
	bit<8> ver_ihl
	bit<8> diffserv
	bit<16> total_len
	bit<16> identification
	bit<16> flags_offset
	bit<8> ttl
	bit<8> protocol
	bit<16> hdr_checksum
	bit<32> src_addr
	bit<32> dst_addr
}

struct udp_h {
	bit<16> src_port
	bit<16> dst_port
	bit<16> length
	bit<16> checksum
}

struct vxlan_h {
	bit<8> flags
	bit<24> reserved
	bit<24> vni
	bit<8> reserved2
}

struct cksum_state_t {
	bit<16> state_0
}

struct psa_ingress_output_metadata_t {
	bit<8> class_of_service
	bit<8> clone
	bit<16> clone_session_id
	bit<8> drop
	bit<8> resubmit
	bit<32> multicast_group
	bit<32> egress_port
}

struct psa_egress_output_metadata_t {
	bit<8> clone
	bit<16> clone_session_id
	bit<8> drop
}

struct psa_egress_deparser_input_metadata_t {
	bit<32> egress_port
}

struct vxlan_encap_arg_t {
	bit<48> ethernet_dst_addr
	bit<48> ethernet_src_addr
	bit<16> ethernet_ether_type
	bit<8> ipv4_ver_ihl
	bit<8> ipv4_diffserv
	bit<16> ipv4_total_len
	bit<16> ipv4_identification
	bit<16> ipv4_flags_offset
	bit<8> ipv4_ttl
	bit<8> ipv4_protocol
	bit<16> ipv4_hdr_checksum
	bit<32> ipv4_src_addr
	bit<32> ipv4_dst_addr
	bit<16> udp_src_port
	bit<16> udp_dst_port
	bit<16> udp_length
	bit<16> udp_checksum
	bit<8> vxlan_flags
	bit<24> vxlan_reserved
	bit<24> vxlan_vni
	bit<8> vxlan_reserved2
	bit<32> port_out
}

header ethernet instanceof ethernet_h
header ipv4 instanceof ipv4_h
header outer_ethernet instanceof ethernet_h
header outer_ipv4 instanceof ipv4_h
header outer_udp instanceof udp_h
header outer_vxlan instanceof vxlan_h
header cksum_state instanceof cksum_state_t

struct my_ingress_metadata_t {
	bit<32> psa_ingress_input_metadata_ingress_port
	bit<8> psa_ingress_output_metadata_drop
	bit<32> psa_ingress_output_metadata_egress_port
	bit<16> Ingress_tmp
	bit<16> Ingress_tmp_0
}
metadata instanceof my_ingress_metadata_t

action NoAction args none {
	return
}

action vxlan_encap args instanceof vxlan_encap_arg_t {
	validate h.outer_ethernet
	mov h.outer_ethernet.src_addr t.ethernet_src_addr
	mov h.outer_ethernet.dst_addr t.ethernet_dst_addr
	mov h.outer_ethernet.ether_type t.ethernet_ether_type
	validate h.outer_ipv4
	mov h.outer_ipv4.ver_ihl t.ipv4_ver_ihl
	mov h.outer_ipv4.diffserv t.ipv4_diffserv
	mov h.outer_ipv4.total_len t.ipv4_total_len
	mov h.outer_ipv4.identification t.ipv4_identification
	mov h.outer_ipv4.flags_offset t.ipv4_flags_offset
	mov h.outer_ipv4.ttl t.ipv4_ttl
	mov h.outer_ipv4.protocol t.ipv4_protocol
	mov h.outer_ipv4.hdr_checksum t.ipv4_hdr_checksum
	mov h.outer_ipv4.src_addr t.ipv4_src_addr
	mov h.outer_ipv4.dst_addr t.ipv4_dst_addr
	validate h.outer_udp
	mov h.outer_udp.src_port t.udp_src_port
	mov h.outer_udp.dst_port t.udp_dst_port
	mov h.outer_udp.length t.udp_length
	mov h.outer_udp.checksum t.udp_checksum
	validate h.outer_vxlan
	mov h.outer_vxlan.flags t.vxlan_flags
	mov h.outer_vxlan.reserved t.vxlan_reserved
	mov h.outer_vxlan.vni t.vxlan_vni
	mov h.outer_vxlan.reserved2 t.vxlan_reserved2
	mov m.psa_ingress_output_metadata_egress_port t.port_out
	mov m.Ingress_tmp h.outer_ipv4.hdr_checksum
	mov m.Ingress_tmp_0 h.ipv4.total_len
	ckadd h.cksum_state.state_0 h.outer_ipv4.hdr_checksum
	ckadd h.cksum_state.state_0 h.ipv4.total_len
	mov h.outer_ipv4.hdr_checksum h.cksum_state.state_0
	mov h.outer_ipv4.total_len t.ipv4_total_len
	add h.outer_ipv4.total_len h.ipv4.total_len
	mov h.outer_udp.length t.udp_length
	add h.outer_udp.length h.ipv4.total_len
	return
}

action drop_1 args none {
	mov m.psa_ingress_output_metadata_egress_port 0x1
	return
}

table vxlan {
	key {
		h.ethernet.dst_addr exact
	}
	actions {
		vxlan_encap
		drop_1
		NoAction
	}
	default_action drop_1 args none const
	size 0x10000
}


apply {
	rx m.psa_ingress_input_metadata_ingress_port
	mov m.psa_ingress_output_metadata_drop 0x0
	extract h.ethernet
	extract h.ipv4
	table vxlan
	jmpneq LABEL_DROP m.psa_ingress_output_metadata_drop 0x0
	emit h.outer_ethernet
	emit h.outer_ipv4
	emit h.outer_udp
	emit h.outer_vxlan
	emit h.ethernet
	emit h.ipv4
	tx m.psa_ingress_output_metadata_egress_port
	LABEL_DROP :	drop
}


" 